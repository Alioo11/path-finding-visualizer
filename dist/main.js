/*! For license information please see main.js.LICENSE.txt */
(()=>{"use strict";var t={d:(e,n)=>{for(var o in n)t.o(n,o)&&!t.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:n[o]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)};t.d({},{g:()=>Ot,C:()=>At});const e="target",n={animationDuration:1e3,default:!0},o=(t,o,l=n)=>{t.style.animationDuration=l.default?"":`${l.animationDuration}ms`,t.className=t.className===e?e:o},l=(t,e)=>{localStorage.getItem("WIDTH")<40&&(t.innerHTML=e)},i=(t,e,o=n)=>{t.style.animationDuration=o.default?"":`${o.animationDuration}ms`,t.className=e};function s(t,e,n,o){this.node=t,this.orgin=e,this.type=n,this.cost=o}const a=t=>new Promise(((e,n)=>{setTimeout((()=>{e()}),t||30)}));function r(){let t=(parseInt(window.innerWidth/30)-2)%2==0?parseInt(window.innerWidth/30)-3:parseInt(window.innerWidth/30)-2,e=window.innerWidth<400?parseInt(window.innerHeight/30)-1:parseInt(window.innerHeight/30)-3-2,n=!1,o=null,l=null;localStorage.setItem("WIDTH",t),localStorage.setItem("HEIGHT",e),this.getWidth=()=>t,this.getHeight=()=>e,this.getAlgorithm=()=>o,this.getMazeAlgorithm=()=>l,this.getRunning=()=>n,this.swapRunning=()=>{n=!n},this.setAlgorithm=t=>{o=t},this.setMazeAlgorithm=t=>{l=t},this.setWidth=e=>{t=e,console.log(t)},this.setHeight=t=>{e=t}}const c=new r,d=(t,e=1,n=!1)=>{const o=c.getWidth(),l=c.getHeight();if(!t)return[];const i=[],s=parseInt(t.id);return s-o*e>=0&&i.push(Ot[s-o*e]),s%o+e<o&&i.push(Ot[s+1*e]),s+o*e<o*l&&i.push(Ot[s+o*e]),s%o>=e&&i.push(Ot[s-1*e]),i?i.filter((t=>"cell"===t.className||"weight"===t.className||"target"===t.className||n?"wall":"")):[]},h=(t,e=1,n)=>{const o=c.getWidth(),l=c.getHeight();if(!t)return[];const i=[],s=parseInt(t.id);return s-o*e>=0&&i.push(Ot[s-o*e]),s%o+e<o&&i.push(Ot[s+1*e]),s+o*e<o*l&&i.push(Ot[s+o*e]),s%o>=e&&i.push(Ot[s-1*e]),i?n?i.filter((t=>n.includes(t.className))):i:[]},g=async t=>{const e=[];for(;null!==t.orgin;)e.push(t.node),t=t.orgin;for(let t=e.length-1;t>=0;t--)await a(10),o(e[t],"path",{animationDuration:1e3})};class u{constructor(t,e=null,n=null){this.data=t,this.left=e,this.right=n}}class f{constructor(){this.root=null}add(t){const e=this.root;if(null!==e){const n=function(e){if(t<e.data){if(null===e.left)return void(e.left=new u(t));if(null!==e.left)return n(e.left)}else{if(!(t>e.data))return null;if(null===e.right)return void(e.right=new u(t));if(null!==e.right)return n(e.right)}};return n(e)}this.root=new u(t)}findMin(){let t=this.root;for(;null!==t.left;)t=t.left;return t.data}findMax(){let t=this.root;for(;null!==t.right;)t=t.right;return t.data}find(t){if(!t||!this.root)return null;let e=this.root;for(;e.data!==t;)if(e=t<e.data?e.left:e.right,null===e)return null;return e}isPresent(t){let e=this.root;for(;e;){if(t===e.data)return!0;e=t<e.data?e.left:e.right}return!1}remove(t){const e=function(t,n){if(null==t)return null;if(n==t.data){if(null==t.left&&null==t.right)return null;if(null==t.left)return t.right;if(null==t.right)return t.left;for(var o=t.right;null!==o.left;)o=o.left;return t.data=o.data,t.right=e(t.right,o.data),t}return n<t.data?(t.left=e(t.left,n),t):(t.right=e(t.right,n),t)};this.root=e(this.root,t)}isBalanced(){return this.findMinHeight()>=this.findMaxHeight()-1}findMinHeight(t=this.root){if(null==t)return-1;let e=this.findMinHeight(t.left),n=this.findMinHeight(t.right);return e<n?e+1:n+1}findMaxHeight(t=this.root){if(null==t)return-1;let e=this.findMaxHeight(t.left),n=this.findMaxHeight(t.right);return e>n?e+1:n+1}inOrder(){if(null==this.root)return null;{var t=new Array;function e(n){n.left&&e(n.left),t.push(n.data),n.right&&e(n.right)}return e(this.root),t}}preOrder(){if(null==this.root)return null;{var t=new Array;function e(n){t.push(n.data),n.left&&e(n.left),n.right&&e(n.right)}return e(this.root),t}}postOrder(){if(null==this.root)return null;{var t=new Array;function e(n){n.left&&e(n.left),n.right&&e(n.right),t.push(n.data)}return e(this.root),t}}levelOrder(){let t=[],e=[];if(null!=this.root){for(e.push(this.root);e.length>0;){let n=e.shift();t.push(n.data),null!=n.left&&e.push(n.left),null!=n.right&&e.push(n.right)}return t}return null}}const m="scaning",p="target",w="entry",y="weight";let I=!!localStorage.getItem("detail-mode")&&localStorage.getItem("detail-mode"),N=function(){let t=[null],e=new f;this.insert=function(n){if(!e.find(parseInt(n.node?.id))&&(e.add(parseInt(n.node?.id)),t.push(n),t.length>2)){let e=t.length-1;for(;t[e].cost<t[Math.floor(e/2)].cost;)if(e>=1){if([t[Math.floor(e/2)].cost,t[e].cost]=[t[e].cost,t[Math.floor(e/2)].cost],!(Math.floor(e/2)>1))break;e=Math.floor(e/2)}}},this.remove=function(){let n=t[1];if(t.length>2){if(t[1]=t[t.length-1],t.splice(t.length-1),3==t.length)return t[1].cost>t[2].cost&&([t[1],t[2]]=[t[2],t[1]]),n;let e=1,o=2*e,l=2*e+1;for(;(t[e]?.cost>=t[o]?.cost||t[e]?.cost>=t[l]?.cost)&&(t[o].cost<t[l].cost?([t[e],t[o]]=[t[o],t[e]],e*=2):([t[e],t[l]]=[t[l],t[e]],e=2*e+1),o=2*e,l=2*e+1,null!=t[o]?.cost&&null!=t[l]?.cost););}else{if(2!=t.length)return null;t.splice(1,1)}return e.remove(parseInt(n.node.id)),n},this.items=function(){return t},this.best=function(){return t[1]}},v=[],E=0;const S=function(){this.collection=[],this.bestNode=null,this.add=t=>{this.collection.filter((e=>e.node?.id==t.id)).length>0?this.collection=this.collection.filter((e=>e.node?.id!==t.id)):this.collection.push(t)},this.delete=t=>(this.collection=this.collection.filter((e=>e?.node?.id!==t.node.id)),this.collection),this.findBestNode=()=>(this.bestNode=this.collection.reduce(((t,e)=>t.cost>e.cost?e:t)),this.bestNode),this.reSort=()=>this.collection.sort(((t,e)=>t.cost-e.cost)),this.show=()=>{console.log(this.collection)},this.col=()=>this.collection};let k=0,b=!!localStorage.getItem("detail-mode")&&localStorage.getItem("detail-mode"),_=[];const H="scaning",M="target",B="entry",L="weight",W=new r;let A=0;const D=W.getWidth(),$=W.getHeight(),z="cell",x=[],O=async(t,e)=>{if(e&&(A=localStorage.getItem("maze_speed")?80*(5-localStorage.getItem("maze_speed"))+20:30,x.push(t),await(async()=>{for(let t=0;t<$;t++){await a(2);for(let e=0;e<D;e++)o(Ot[D*t+e],"wall")}})()),0===x.length)return;const n=h(x[x.length-1],2).filter((t=>"cell"!==t.className));if(0===n.length)x.pop();else{o(t,"path"),await a(A);const e=n[(0,l=n.length,Math.floor(Math.random()*(l-0)+0))];x.push(e);const i=((t,e)=>{const n=parseInt(e.id)-parseInt(t.id),o=parseInt(t.id);return n===2*D?Ot[o+D]:n===-2*D?Ot[o-D]:-2===n?Ot[o-1]:2===n?Ot[o+1]:void 0})(t,x[x.length-1]);o(i,z,{animationDuration:1e3})}var l;o(t,z),O(x[x.length-1])},j=new r,T=(t,e)=>{const n=j.getWidth();if(j.getHeight(),!t||!e)return null;const o=Math.abs(parseInt(t.id)%n-parseInt(e.id)%n),l=Math.abs(Math.floor(parseInt(t.id)/n)-Math.floor(parseInt(e.id)/n));return Math.ceil(Math.sqrt(o**2+l**2))},q="scaning",P="target",C="entry",R="weight";let F=!!localStorage.getItem("detail-mode")&&localStorage.getItem("detail-mode");function G(t,e,n,o,l){this.node=t,this.orgin=e,this.type=n,this.cost=o,this.heuristic=l}const J=function(){this.collection=[],this.bestNode=null,this.add=t=>{this.collection.filter((e=>e.node?.id==t.id)).length>0?this.collection=this.collection.filter((e=>e.node?.id!==t.id)):this.collection.push(t)},this.delete=t=>(this.collection=this.collection.filter((e=>e?.node?.id!==t.node.id)),this.collection),this.findBestNode=()=>(this.bestNode=this.collection.reduce(((t,e)=>t.cost+t.heuristic>e.cost+e.heuristic?e:t)),this.bestNode),this.reSort=()=>this.collection.sort(((t,e)=>t.cost-e.cost)),this.show=()=>{console.log(this.collection)},this.col=()=>this.collection};let K=0,Q=[];const U="scaning",V="target",X="entry",Y="weight";let Z=!!localStorage.getItem("detail-mode")&&localStorage.getItem("detail-mode");function tt(t,e,n,o,l){this.node=t,this.orgin=e,this.type=n,this.cost=o,this.heuristic=l}const et=function(){this.collection=[],this.bestNode=null,this.add=t=>{this.collection.filter((e=>e.node?.id==t.id)).length>0?this.collection=this.collection.filter((e=>e.node?.id!==t.id)):this.collection.push(t)},this.delete=t=>(this.collection=this.collection.filter((e=>e?.node?.id!==t.node.id)),this.collection),this.findBestNode=()=>(this.bestNode=this.collection.reduce(((t,e)=>t.heuristic>e.heuristic?e:t)),this.bestNode),this.reSort=()=>this.collection.sort(((t,e)=>t.cost-e.cost)),this.show=()=>{console.log(this.collection)},this.col=()=>this.collection};let nt=0,ot=[];const lt=new r;lt.getWidth(),lt.getHeight();const it=new r;it.getWidth(),it.getHeight();const st="cell",at=new r,rt=at.getWidth(),ct=at.getHeight(),dt=(t,e)=>Math.floor(Math.random()*(e-t)+t);function ht(){let t=[],e=0;this.init=n=>{t=n,e=n.length},this.items=()=>t,this.size=()=>e,this.findSequence=e=>{let n;for(let o=0;o<t.length;o++)if(n=t[o].every(((t,n)=>t==e[n])),n)return t[o];return null},this.findSequenceIndex=e=>{let n;for(let o=0;o<t.length;o++)if(n=t[o].every(((t,n)=>t==e[n])),n)return o;return null},this.findOne=e=>{let n;for(let o=0;o<t.length;o++)if(n=t[o].includes(e),n)return t[o];return null},this.remove=e=>{const n=this.findSequenceIndex(e);if(null===n)return!1;t=t.slice(0,n).concat(t.slice(n+1,t.length))},this.pushTo=(e,n)=>{const o=this.findSequenceIndex(e);if(null==o)return!1;t=t.map(((t,e)=>e==o?t.concat(n):t))}}document.getElementById("algo_dijkestra").addEventListener("click",(t=>{localStorage.setItem("algorithm","dijkestra")})),document.getElementById("algo_A_start").addEventListener("click",(t=>{localStorage.setItem("algorithm","a_start")})),document.getElementById("algo_dijkestra_heap_based").addEventListener("click",(t=>{localStorage.setItem("algorithm","dijkestra_heap_based")})),document.getElementById("algo_greedy").addEventListener("click",(t=>{localStorage.setItem("algorithm","greedy")})),document.querySelector("#clear_maze").addEventListener("click",(()=>jt()));const gt=document.getElementById("detail-mode");document.getElementById("detail-mode").addEventListener("click",(()=>{Wt()}));const ut=document.getElementById("maze_algorithm_speed"),ft=document.getElementById("algorithm_speed"),mt=document.getElementById("create_maze"),pt=new r;let wt=1,yt=null,It=null,Nt=!1;const vt=pt.getWidth(),Et=pt.getHeight();let St=!1,kt=!1,bt=!1,_t=!1,Ht=null,Mt=null;document.addEventListener("mousedown",(t=>{"entry"!=t.target.className&&"target"!=t.target.className||(Ht=t.target.className,_t=!0)})),document.addEventListener("mouseup",(t=>{_t=!1,Ht=null}));const Bt="entry",Lt="cell",Wt=()=>{localStorage.setItem("detail-mode",gt.checked)},At=()=>new Promise(((t,e)=>{document.addEventListener("keydown",(e=>{if("f"===e.key||"F"==e.key)return t()}))}));localStorage.removeItem("maze_speed"),localStorage.removeItem("algorithm_speed"),localStorage.removeItem("algorithm"),localStorage.removeItem("detail-mode");const Dt=document.getElementsByClassName("board"),$t=document.getElementById("start_btn");var zt,xt;ut.addEventListener("change",(t=>localStorage.setItem("maze_speed",t.target.value))),ft.addEventListener("change",(t=>localStorage.setItem("algorithm_speed",t.target.value))),mt.addEventListener("click",(t=>qt())),$t.addEventListener("click",(()=>{Nt=!Nt,Tt()})),Dt[0].style.gridTemplateColumns=`repeat( ${vt} , 30px)`,zt=vt,xt=Et,Dt[0].innerHTML=Array.from(Array.from(Array(zt*xt).keys()),(t=>`<div id='${t}' class='cell'></div>`)).join().replace(/,/g,"");const Ot=document.querySelectorAll(".cell"),jt=async()=>{wt=1;for(let t=0;t<Ot.length;t++)t%vt==0&&await a(40),i(Ot[t],Lt),i(Ot[Ot.length-t-1],Lt),l(Ot[t],""),l(Ot[Ot.length-t-1],"")},Tt=async t=>{if(3===wt&&yt){const n=localStorage.getItem("algorithm")?localStorage.getItem("algorithm"):null;switch(console.time(),n){case"dijkestra_heap_based":if(t){(t=>{const e=new N,n=async(t,i)=>{if(i&&v.forEach((t=>{"wall"!=t.node.className&&t.node.className!=y&&(o(t.node,"cell"),l(t.node,""))})),v.push(t),o(t.node,i?w:m),t.node.className!==p)d(t.node).forEach((n=>{const o=new s(n,t,m,t.cost+(n.className===y?10:1));e.insert(o)})),e.remove(),n(e.best());else{const e=[];for(;null!==t.orgin;)e.push(t.node),t=t.orgin;for(let t=e.length-1;t>=0;t--)o(e[t],"path")}};n(t,!0)})(new s(yt,null,Bt,0));break}await(async t=>new Promise(((e,n)=>{const i=new N,r=async(t,n)=>{if(I=localStorage.getItem("detail-mode"),I&&"false"!==I&&await At(),v.push(t),o(t.node,n?w:m,{animationDuration:500}),!n||(E=20*(5-localStorage.getItem("algorithm_speed"))+2),l(t.node,`c:${t.cost}`),t.node.className===p)return g(t),e();await a(E),d(t.node).forEach((e=>{const n=new s(e,t,m,t.cost+(e.className===y?10:1));I&&o(e,"candidate"),I&&l(e,`c:${n.cost}`),i.insert(n)})),r(i.best()),i.remove()};return r(t,!0)})))(new s(yt,null,Bt,0));break;case"dijkestra":default:if(t){(t=>{const e=new S,n=(t,i)=>{if(i&&(_.forEach((t=>{"wall"!=t.node.className&&t.node.className!=L&&(o(t.node,"cell"),l(t.node,""))})),_=[]),_.push(t),o(t.node,i?B:H),t.node.className!==M)e.delete(t),d(t.node).forEach((n=>{const o=new s(n,t,H,t.cost+(n.className===L?30:1));e.add(o)})),n(e.findBestNode());else{const e=[];for(;null!==t.orgin;)e.push(t.node),t=t.orgin;for(let t=e.length-1;t>=0;t--)o(e[t],"path")}};n(t,!0)})(new s(yt,null,Bt,0));break}await(e=new s(yt,null,Bt,0),new Promise(((t,n)=>{const i=new S,r=async(e,n)=>{if(b=localStorage.getItem("detail-mode"),b&&"false"!==b&&await At(),_.push(e),o(e.node,n?B:H,{animationDuration:500}),!n||(k=20*(5-localStorage.getItem("algorithm_speed"))+2),l(e.node,`c:${e.cost}`),e.node.className===M)return g(e),t();await a(k),i.delete(e),d(e.node).forEach((t=>{const n=new s(t,e,H,e.cost+(t.className===L?30:1));b&&o(t,"candidate"),b&&l(t,`c:${n.cost}`),i.add(n)})),r(i.findBestNode())};return r(e,!0)})));break;case"a_start":if(t){((t,e)=>{const n=new J,i=(t,s)=>{if(Q.push(t),s&&Q.forEach((t=>{"wall"!=t.node.className&&t.node.className!=R&&(o(t.node,"cell"),l(t.node,""))})),o(t.node,s?C:q),t.node.className!==P)n.delete(t),d(t.node).forEach((o=>{const l=t.cost+(o.className===R?10:1),i=T(o,e),s=new G(o,t,q,l,i);n.add(s)})),i(n.findBestNode());else{const e=[];for(;null!==t.orgin;)e.push(t.node),t=t.orgin;for(let t=e.length-1;t>=0;t--)o(e[t],"path")}};i(t,!0)})(new s(yt,null,Bt,0),It);break}await((t,e)=>{const n=new J,i=async(t,s)=>{!s||(K=20*(5-localStorage.getItem("algorithm_speed"))+2),F=localStorage.getItem("detail-mode"),F&&"false"!==F&&await At(),Q.push(t),o(t.node,s?C:q,{animationDuration:500}),l(t.node,`C:${t.cost} <br/> H:${0==t.cost?0:t.heuristic}`),t.node.className!==P?(await a(K),n.delete(t),d(t.node).forEach((i=>{const s=t.cost+(i.className===R?10:1),a=T(i,e),r=new G(i,t,q,s,a);F&&o(i,"candidate"),F&&l(i,`C:${r.cost} <br/> H:${0==r.cost?0:r.heuristic}`),n.add(r)})),i(n.findBestNode())):g(t)};return i(t,!0)})(new s(yt,null,Bt,0),It);break;case"greedy":if(t){((t,e)=>{const n=new et,i=(t,s)=>{if(s&&ot.forEach((t=>{"wall"!=t.node.className&&t.node.className!=Y&&(o(t.node,"cell"),l(t.node,""))})),ot.push(t),o(t.node,s?X:U),t.node.className!==V)n.delete(t),d(t.node).forEach((o=>{const l=t.cost+(o.className===Y?10:1),i=T(o,e),s=new tt(o,t,U,l,i);n.add(s)})),i(n.findBestNode());else{const e=[];for(;null!==t.orgin;)e.push(t.node),t=t.orgin;for(let t=e.length-1;t>=0;t--)o(e[t],"path")}};i(t,!0)})(new s(yt,null,Bt,0),It);break}((t,e)=>{const n=new et,i=async(t,s)=>{!s||(nt=20*(5-localStorage.getItem("algorithm_speed"))+2),Z=localStorage.getItem("detail-mode"),Z&&"false"!==Z&&await At(),ot.push(t),o(t.node,s?X:U,{animationDuration:500}),t.node.className!==V?(await a(nt),n.delete(t),d(t.node).forEach((i=>{const s=t.cost+(i.className===Y?10:1),a=T(i,e),r=new tt(i,t,U,s,a);Z&&o(i,"candidate"),Z&&l(i,`H:${0==r.cost?0:r.heuristic}`),n.add(r)})),i(n.findBestNode())):g(t)};i(t,!0)})(new s(yt,null,Bt,0),It)}console.timeEnd()}var e},qt=()=>{wt=1,yt&&o(yt,Lt),It&&i(It,Lt),localStorage.getItem("maze_algo"),(async()=>{const t=(()=>{const t=new ht,e=Array.from(Array.from(Array(rt*ct).keys()),(t=>[t])).filter((t=>t%rt%2!=0&&parseInt(t/rt)%2!=0));return t.init(e),t})(),e=async n=>{if(await a(10),n&&await(async()=>{for(let t=0;t<ct;t++){await a(2);for(let e=0;e<rt;e++)o(Ot[rt*t+e],"wall")}})(),1===t.items().length)return;const l=t.items()[dt(0,t.items().length)],i=l.length>1?l[dt(0,l.length)]:l[0],s=h(Ot[i],2);if(0===s.length)return console.log("%c neighours empty","background : purple"),void e();const r=s.length>1?s[dt(0,s.length)]:s[0],c=((t,e)=>{const n=parseInt(e.id)-parseInt(t.id),o=parseInt(t.id);return n===2*rt?Ot[o+rt]:n===-2*rt?Ot[o-rt]:-2===n?Ot[o-1]:2===n?Ot[o+1]:void 0})(Ot[i],r),d=t.findOne(i),g=t.findOne(parseInt(r.id));d.every(((t,e)=>t===g[e]))||(o(Ot[i],st),o(c,st),o(r,st),t.pushTo(d,g),t.remove(g)),e()};e(!0)})()};Ot.forEach((t=>{t.addEventListener("click",(t=>{(t=>{switch(wt){case 0:O(Ot[vt+1],!0),wt+=1;break;case 1:o(t,"target"),It=t,wt+=1;break;case 2:o(t,Bt),yt=t,wt+=1}})(t.target)}))})),window.addEventListener("keydown",(t=>{St="x"===t.key,kt="w"===t.key,bt="e"===t.key,"v"==t.key&&Tt(),"m"==t.key&&qt()})),window.addEventListener("keyup",(()=>{St=!1,kt=!1,bt=!1})),Ot.forEach((t=>{t.addEventListener("mouseover",(t=>{St&&(o(t.target,"weight"),l(t.target,3)),kt&&o(t.target,"wall"),bt&&o(t.target,Lt),_t&&(Mt=t.target.className,("entry"==Ht&&"target"!==t.target.className||"target"==Ht&&"entry"!==t.target.className)&&(i(t.target,Ht),"entry"==Ht?yt=t.target:"target"==Ht&&(It=t.target),console.log(wt),wt>1&&Tt(!0)))}))})),Ot.forEach((t=>{t.addEventListener("mouseout",(t=>{_t&&i(t.target,Mt||Lt)}))}))})();